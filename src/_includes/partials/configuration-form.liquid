<div class="py-5 px-4 sm:px-6 my-8 divide-y divide-gray-300 overflow-hidden rounded-lg bg-gray-100 shadow">
  <div class="py-5">
    <h2 class="text-base font-semibold leading-7 text-gray-900">Your Current Customer.io JS Snippet Configuration</h2>
    <p class="mt-1 text-sm leading-6 text-gray-600">This data will be used to link your activity on this site to your Customer.io workspace.</p>
  </div>
  <div class="py-5">
    <form id="set_cio_config">
      <div class="space-y-12 my-4">
        <div class="border-b border-gray-900/10 pb-12">
          <div class="mt-6 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
            <div class="sm:col-span-4">
              <label for="siteID" class="block text-sm font-medium leading-6 text-gray-900">Site ID</label>
              <div class="mt-2">
                <div class="flex rounded-md shadow-sm ring-1 ring-inset ring-gray-300 focus-within:ring-2 focus-within:ring-inset focus-within:ring-indigo-600 sm:max-w-md">
                  <input
                    type="text"
                    name="siteID"
                    id="siteID"
                    class="block flex-1 border-0 rounded-md py-1.5 pl-1 text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6"
                    placeholder="YOUR_SITE_ID">
                </div>
              </div>
            </div>
            <div class="sm:col-span-3">
              <label for="region" class="block text-sm font-medium leading-6 text-gray-900">Region</label>
              <div class="mt-2">
                <select
                  id="region"
                  name="region"
                  autocomplete="region-name"
                  class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6">
                  <option id="regionUS" value="regionUS">US</option>
                  <option id="regionEU" value="regionEU">EU</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="mt-6 flex items-center justify-start gap-x-6">
        <button
          type="button"
          id="cancel"
          class="text-sm font-semibold leading-6 text-gray-900">Cancel</button>
        <button type="submit" class="rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Save</button>
      </div>
    </form>
  </div>
</div>

<section class="bg-gray-200 sm:w-[calc(100%+4rem)] sm:-mx-[2rem] sm:px-[2rem] px-4">
  <noscript>
    <h2 class="">Warning â€” JavaScript disabled</h2>
    <p>This Form submission will not update the CIO tracking config, in fact, while JavaScript is disabled, you're not being tracked by the JS Snippet.</p>
  </noscript>
</section>
<script>
  var form = document.getElementById("set_cio_config");
  var siteIDInput = document.getElementById("siteID");
  var cancelBtn = document.getElementById("cancel");
  var regionSelect = document.getElementById("region");
  var regionOptions = {
    "us": document.getElementById("regionUS"),
    "eu": document.getElementById("regionEU")
  };

  function setFormValues() {
    let {siteID: currentSiteID, region: currentRegion} = window.getCioConfig();
    siteIDInput.value = currentSiteID;
    if (`${currentRegion}`.toLowerCase() == "us") {
      regionOptions.eu.removeAttribute("selected");
      regionOptions.us.setAttribute("selected", true);
      regionSelect.value = "regionUS"
    } else {
      regionOptions.us.removeAttribute("selected");
      regionOptions.eu.setAttribute("selected", true);
      regionSelect.value = "regionEU"
    }
    console.log("form fields set")
  }
  cancelBtn.addEventListener("click", function resetForm(cancelEvent) {
    setFormValues()
  })

  window.addEventListener("load", function setCurrentValues(loadEvent) {
    setFormValues()
  })

  form.addEventListener("submit", function handleSubmit(submitEvent) {
    submitEvent.preventDefault()
    const data = new FormData(form);
    let cioConfig = {
      site_id: undefined,
      region: undefined
    };
    for (const [name, value] of data) {
      cioConfig = Object.assign({}, cioConfig, {[`${name}`]: value})
    }
    console.log({cioConfig})
    window.updateCioConfig(cioConfig);
  })
</script>